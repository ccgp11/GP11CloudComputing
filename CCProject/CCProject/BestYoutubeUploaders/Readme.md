### 介绍

该程序在原repository中对应的程序是`TopYoutubeUploader`,但原程序只是统计了所有上传者的上传数量，而没有根据
上传数量来对上传者进行排序。因此，本程序加入了根据上传者的上传数量对其进行排序的task，按照从高到低的顺序，对上传者上传视频的数量进行排名。

输出包括两部分：

- 对每个上传者上传视频数量的统计，保存在result/temp/文件夹下
- 根据上传视频的数量，对上传者进行排序的结果，保存在result/final/文件夹下



结果的输出格式如下所示：

| 上传者id | 上传数量 |
|-------|------|

由高到低表示。

## ChatGPT生成


这段Java代码是一个使用Apache Hadoop框架的MapReduce程序，其目的是找出数据集中上传视频数量最多的YouTube上传者。程序分为两个阶段的作业：第一阶段计数每个上传者的上传视频次数，第二阶段按这些次数降序排序上传者。

### 第一阶段：计数上传者的视频上传次数

#### Mapper类：Map

- **功能**：处理输入的文本行，提取上传者的名字，对每个上传记录计数1。
- **逻辑**：每行文本以逗号分隔，假设至少有七个字段（第二个字段是上传者的名字），为每个上传者输出键值对（上传者名，1）。

#### Reducer类：Reduce

- **功能**：对相同的上传者收到的计数值进行累加，输出每个上传者的总上传次数。
- **逻辑**：对于每个上传者，通过累加其所有的计数值（传入的值），计算总数，输出（上传者名，总数）。

### 第二阶段：按上传次数排序上传者

#### Mapper类：SortMap

- **功能**：处理第一阶段的输出，交换键和值，即把上传次数作为键，上传者名作为值。
- **逻辑**：读取以制表符分隔的行（`uploader\ttotaloccurance`），输出（总上传次数，上传者名）。

#### Reducer类：SortReduce

- **功能**：收集所有上传者及其上传次数，使用`TreeMap`按键（上传次数）自然排序。
- **逻辑**：由于需要降序输出，所以在`cleanup`阶段，使用`TreeMap`的`descendingMap`方法反转排序后输出所有键值对。

#### 自定义比较器

- **比较器**：使用`IntWritable.Comparator`类进行自然顺序排序。

### 主方法

- **第一作业**：配置并启动第一阶段的作业，其目标是计数每个上传者的视频上传次数。输出存储在临时目录。
- **第二作业**：在第一作业完成后，配置并启动第二阶段的作业，从临时目录读取数据，进行排序，并将结果输出到最终目录。

### 特别注意

- **作业依赖**：第二作业的执行依赖第一作业的完成，这通过`waitForCompletion`方法的返回值来控制。
- **输出格式**：最终输出为按上传次数降序排列的上传者列表。

此程序通过两阶段处理来分析和排列上传者，是大数据环境中常见的多阶段MapReduce处理的示例，适用于诸如社交媒体分析、内容生成者活动分析等应用场景。
